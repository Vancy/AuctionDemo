<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/core-ajax/core-ajax.html">
<link rel="import" href="auction-saa-table.html">


<polymer-element name="auction-saa">
  <template>
    <link rel="stylesheet" href="./auction-saa.css" type="text/css" />
    
    


    <div id="auction-saa">
      <p>Round {{ round }}</p>
      <p id="time"></p>
      <auction-saa-table id="table" items="{{ items }}" final="{{ isFinal }}"></auction-saa-table>
      <button id="bid">Bid</button>
    </div>



  </template>

  <script>
    Polymer('auction-saa', {
      saa: {},

      round: -1,
      timeRemain: 0,
      minimumIncreament: 0,
      items: [],
      isFinal: false,


      setData: function(data) {
        console.log("saa.getData", data);
        this.saa = data;
        this.updateInfomation();

        // start ajax timer
      },

      updateInfomation: function() {
        this.items = this.saa.auction_context.item;
        this.round = this.saa.auction_context.round._value;
        this.timeRemain = this.saa.auction_context.duration._remain;
        this.minimumIncreament = this.saa.auction_context.minimum_increament._value;

        this.isFinal = this.saa.auction_context.round._final == "no" ? false : true;

        this.$.bid.disabled = false;
        if ( ! this.isAuctionStarted() ) {
          this.$.time.innerHTML = "Please wait, auction haven't started yet.";
          this.$.bid.disabled = true;
          // not stated yet
        }
        if ( this.isFinal ) {
          this.$.time.innerHTML = "Time remain: " + this.timeRemain + "s";
          this.$.bid.disabled = true;
          // final
        }
        console.log(this.items);

      },

      isAuctionStarted: function() {
        if ( this.saa.auction_context.round._value == "0" ) {
          return false
        }
        return true;
      },


    });
  </script>
</polymer-element>